{
  "hash": "f134eb60f16e845f393122fa64b684ca",
  "result": {
    "markdown": "---\ntitle: \"Using ggmap after July 2018\"\nauthor: Charlie Joey Hadley\ndate: '2018-12-05'\nslug: using-ggmap-after-july-2018\ncategories:\n  - dataviz\n  - R\ntags:\n  - dataviz\n  - fun\n  - R\nbanner: \"img/blog-images/2018-12-05_ggmap-output.png\"\n---\n\n`ggmap` is an awesome package for creating maps with `ggplot2`. If you've seen a nice looking map built with `ggplot2` I can almost guarantee you that it uses `ggmap` to look that good. The `ggmap` package is used to obtain base maps from the APIs of a number of online mapping tools, the one we care about here is the base maps from Google Maps (because they're very good). \n\nIf you're reading instructions for using `ggmap` written before July 2018 **you will fail to replicate the results** unless you make some changes to your workflow. **You will need to give Google your billing information, but can create maps for free**.\n\n<!-- <div class=\"row\"> -->\n\n<!-- <div class=\"col-sm-6\"> -->\n\n<!-- <a class=\"btn btn-primary btn-block\" data-toggle=\"collapse\" href=\"#whats-an-api\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapseExample\"> -->\n<!--     What's an API? -->\n<!-- </a> -->\n\n<!-- </div> -->\n\n<!-- <div class=\"col-sm-6\"> -->\n\n<!--   <a class=\"btn btn-primary btn-block\" data-toggle=\"collapse\" href=\"#what-are-base-maps\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapseExample\"> -->\n<!--     What are base maps? -->\n<!--   </a> -->\n\n<!-- </div> -->\n\n<!-- </div> -->\n\n<!-- <div class=\"collapse\" id=\"whats-an-api\"> -->\n<!--   <div class=\"card card-body\"> -->\n\n<!-- A defined set of interactions with a service to send and receive data. In the case of mapping tools you'll find many API, including one for converting street addresses into longitude and latitudes. -->\n\n<!--   <br/> -->\n<!--   </div> -->\n<!-- </div> -->\n\n<!-- <div class=\"collapse\" id=\"what-are-base-maps\"> -->\n<!--   <div class=\"card card-body\"> -->\n\n<!-- Base maps are the backgrounds of maps. -->\n\n<!--   <br/> -->\n<!--   </div> -->\n<!-- </div> -->\n\n## What's changed?\n\nBefore July 2018 it was possible to use the Google Maps API for free without configuration or use account, this is now no longer possible. See the [pricing page](https://cloud.google.com/maps-platform/pricing/) for explicit details from Google themselves.\n\nYou must do the following to obtain base maps from Google:\n\n- Have a Google Cloud account.\n\n- Enable the Google Maps Platform.\n\n- Provide Google with your billing details.\n\nYou will then be allocated $200 of free usage per month, every month. All API calls will be made against these limits. \n\nIf you're exclusively making static maps with `ggmap` then *you're extremely unlikely to ever be charged by Google*. I've summarised the [pricing policy](https://developers.google.com/maps/billing/understanding-cost-of-use) as of December 2018 below:\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-b9c0d536f88f46555929\" style=\"width:100%;height:100%;\" class=\"widgetframe html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b9c0d536f88f46555929\">{\"x\":{\"url\":\"index_files/figure-html//widgets/widget_static-map-pricing.html\",\"options\":{\"xdomain\":\"*\",\"allowfullscreen\":false,\"lazyload\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n## Let's make our maps\n\nWe'll break this into two stages:\n\n1. Preparing our Google Maps Platform account\n\n2. Setting up and using `ggmap`\n\n### Preparing our Google Maps Platform account\n\n1. Navigate to [https://cloud.google.com/maps-platform/](https://cloud.google.com/maps-platform/) and click \"Get Started\"\n\n2. Select \"Maps\" in the dialog, leave the other things for another tutorial.\n\n<img src='/blog/2018-12-05-using-ggmap-after-july-2018/2018-12-05_google-maps-platform-dialog.png' style='width:450px'/>\n\n3. Create a new project for tracking your `ggmap`-incurred expenses, I suggest using the name `ggmap`\n\n<img src='/blog/2018-12-05-using-ggmap-after-july-2018/2018-12-05_google-maps-platform-project.png' style='width:450px'/>\n\n4. You'll be prompted to create a billing account, click \"create a billing account\"\n\n5. Select your country, agree to the terms and conditions, and make a decision about marketing. Please note you'll likely be told you're getting \\$300 per month rather than \\$200 for 12 months, it's because Google are trying to keep devs happy during the roll out.\n\n<img src='/blog/2018-12-05-using-ggmap-after-july-2018/2018-12-05_google-maps-platform_create-billing-account.png' style='width:450px'/>\n\n6. Fill in your payment details!\n\n7. As of 2018 there's a modal dialog that you want to click through, I assume this will be designed away in the future so don't worry if you don't see it.\n\n<img src='/blog/2018-12-05-using-ggmap-after-july-2018/2018-12-05_google-maps-platform_enable-your-api.png' style='width:450px'/>\n\n8. Success! Now you have an API key to use in R. You'll want to copy it down somewhere.\n\n<img src='/blog/2018-12-05-using-ggmap-after-july-2018/2018-12-05_google-maps-platform_api-key.png' style='width:450px'/>\n\nYou need to have your API key with you EVERY time that you use `ggmap` for the time being. Make sure you keep a note of it from above, or else you can find it with these steps:\n\n1. Navigate to [https://console.cloud.google.com/apis/dashboard](https://console.cloud.google.com/apis/dashboard) and select the project (I went with `ggmap`) you created from the pull down list:\n\n<img src='/blog/2018-12-05-using-ggmap-after-july-2018/2018-12-05_google-maps-platform_select-project.png' style='width:450px'/>\n\n1. Select credentials from the left-hand nav and you'll be shown your API key\n\n<img src='/blog/2018-12-05-using-ggmap-after-july-2018/2018-12-05_google-maps-platform_credentials.png' style='width:450px'/>\n\n### Setting up and using `ggmap`\n\nThe instructions for these steps can be found in [Github Issue #51](https://github.com/dkahle/ggmap/issues/51).\n\n1. There's a dev version of the `ggmap` package that uses the new APIs, which we can install as follows:\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"dkahle/ggmap\", ref = \"tidyup\")\n```\n:::\n\n2. You **must** now restart R.\n\n3. Load the library and provide your API key\n\n::: {.cell}\n\n```{.r .cell-code}\nregister_google(key = \"My-FAKE-KEY\")\n```\n:::\n\n4. Now we can get our base maps using `get_googlemap()`\n\n::: {.cell}\n\n```{.r .cell-code}\nbase_map <- get_googlemap(center = c(2.2945, 48.858222), maptype = \"roadmap\")\nggmap(base_map)\n```\n:::\n\n<img src='/blog/2018-12-05-using-ggmap-after-july-2018/2018-12-05_ggmap-output.png' style='width:450px'/>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/pymjs-1.3.2/pym.v1.js\"></script>\n<script src=\"../../site_libs/widgetframe-binding-0.3.1/widgetframe.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}